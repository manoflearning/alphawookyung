#include <bits/stdc++.h>
using namespace std;
#define ll long long
#define fr first
#define sc second

const ll INF = 1e18;

int n, len, m;
pair<int, int> a[101010];
int pl[101010], pr[101010];
vector<int> L, R;

void init() {
    memset(pl, 0, sizeof(pl));
    memset(pr, 0, sizeof(pr));
    L.clear();
    R.clear();
}

void input() {
    cin >> n >> len >> m;
    for (int i = 1; i <= n; i++) {
        cin >> a[i].fr >> a[i].sc;
    }
}

int sumr(int s, int e) { return pr[e]; }
int suml(int s, int e) { return pl[s]; }

int getTime(int x) {
    int rcnt = sumr(1, x - 1), lcnt = suml(x + 1, n);
    
    if (a[x].sc < 0) {
        if (rcnt == 0) return a[x].fr;
        else {
            if (rcnt <= lcnt) return L[lcnt - rcnt];
            else return len - R[rcnt - lcnt - 1];
        }
    }

    if (a[x].sc > 0) {
        if (lcnt == 0) return len - a[x].fr;
        else {
            if (rcnt >= lcnt) return len - R[rcnt - lcnt];
            else return L[lcnt - rcnt - 1];
        }
    }

    return -1;
}

int main() {

    cin.tie(NULL); cout.tie(NULL);
    ios_base::sync_with_stdio(false);

    int tc; cin >> tc;
    while (tc--) {
        init();

        input();

        for (int i = 1; i <= n; i++) {
            pr[i] = pr[i - 1];
            if (a[i].sc > 0) {
                pr[i]++;
                R.push_back(a[i].fr);
            }
        }

        for (int i = n; i >= 1; i--) {
            pl[i] = pl[i + 1];
            if (a[i].sc < 0) {
                pl[i]++;
                L.push_back(a[i].fr);
            }
        }

        int l = 1, r = n, ans = -1;
        for (int i = 0; i < m; i++) {
            int lt = getTime(l), rt = getTime(r);
            
            if (make_pair(lt, a[l].sc) <= make_pair(rt, a[r].sc)) ans = a[l++].sc;
            else ans = a[r--].sc;
        }

        cout << ans << '\n';

    }
}